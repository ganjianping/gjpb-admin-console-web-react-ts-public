import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';
import { APP_CONFIG } from './config';

// English translations
const enResources = {
  app: {
    title: 'Admin Console',
  },
  common: {
    loading: 'Loading...',
    error: 'An error occurred',
    retry: 'Retry',
    cancel: 'Cancel',
    confirm: 'Confirm',
    save: 'Save',
    delete: 'Delete',
    edit: 'Edit',
    add: 'Add',
    search: 'Search',
    filter: 'Filter',
    all: 'All',
    actions: 'Actions',
    clearAll: 'Clear All',
    searchFilters: 'Search Filters',
    yes: 'Yes',
    no: 'No',
    close: 'Close',
    view: 'View',
    goBack: 'Go Back',
    goHome: 'Go Home',
    viewAll: 'View All',
    lightMode: 'Light Mode',
    darkMode: 'Dark Mode',
    notifications: 'Notifications',
    userMenu: 'User Menu',
    collapseSidebar: 'Collapse Sidebar',
    expandSidebar: 'Expand Sidebar',
    notAvailable: 'Not Available',
    apply: 'Apply',
    today: 'Today',
    yesterday: 'Yesterday',
    last7Days: 'Last 7 Days',
    last30Days: 'Last 30 Days',
    thisMonth: 'This Month',
    lastMonth: 'Last Month',
    selectDateRange: 'Select Date Range',
    dateRange: 'Date Range',
    startDate: 'Start Date',
    endDate: 'End Date',
    createdAt: 'Created At',
    updatedAt: 'Updated At',
    createdBy: 'Created By',
    updatedBy: 'Updated By',
  },
  navigation: {
    dashboard: 'Dashboard',
    profile: 'Profile',
    settings: 'Settings',
    logout: 'Logout',
    users: 'Users',
    usersList: 'Users List',
    roles: 'Roles',
  },
  auth: {
    unauthorized: 'You are not authorized to access this page',
    sessionExpired: 'Your session has expired, please log in again',
  },
  login: {
    title: 'Admin Console',
    tabs: {
      username: 'Username',
      email: 'Email',
      mobile: 'Mobile',
    },
    form: {
      username: 'Username',
      email: 'Email',
      password: 'Password',
      countryCode: 'Code',
      mobileNumber: 'Mobile Number',
      submit: 'Login',
      forgotPassword: 'Forgot password?',
    },
    errors: {
      invalidCredentials: 'Invalid credentials',
      accountLocked: 'Account is locked',
      generalError: 'Login failed. Please try again.',
    },
    success: 'Login successful',
  },
  errors: {
    notFound: 'Page not found',
    serverError: 'Server error occurred',
    networkError: 'Network error. Please check your connection.',
    pageNotFoundMessage: 'The page you are looking for might have been removed, had its name changed, or is temporarily unavailable.',
    unauthorized: 'Unauthorized Access',
    unauthorizedTitle: 'You do not have permission to access this page',
    unauthorizedMessage: 'If you believe you should have access to this page, please contact your administrator.',
  },
  dashboard: {
    title: '📊 Dashboard Overview',
    welcome: 'Welcome back',
    summary: 'Summary',
    updated: 'Updated',
    recentLoginActivity: {
      title: 'Recent Login',
      viewAll: 'View All',
    },
    stats: {
      totalUsers: 'Total Users',
      activeSessions: 'Active Sessions',
      activeUsers: 'Active Users',
      lockedUsers: 'Locked Users',
      suspendedUsers: 'Suspended Users',
      pendingVerification: 'Pending Verification',
    },
    actions: {
      tokenAuth: 'Token Authentication',
      tokenRevoke: 'Token Revocation',
      tokenValidate: 'Token Validation',
      userCreate: 'User Created',
      userUpdate: 'User Updated',
      userDelete: 'User Deleted',
      userAction: 'User Action',
      userLogin: 'User Login',
      userLogout: 'User Logout',
      passwordReset: 'Password Reset',
      roleManagement: 'Role Management',
      auditAccess: 'Audit Log Access',
      dashboardAccess: 'Dashboard Access',
      apiAccess: 'API Access',
    },
    errors: {
      fetchFailed: 'Failed to fetch dashboard statistics',
      loadFailed: 'Failed to load dashboard statistics',
      tryAgain: 'Please try again later.',
    },
    unknownUser: 'Unknown User',
  },
  auditLogs: {
    title: 'Audit Logs',
    showFilters: 'Show Filters',
    hideFilters: 'Hide Filters',
    active: 'active',
    smartFilteringTooltip: 'Smart Filtering: Filters work instantly as you type for quick results. Use \'Search\' button for server-side filtering with fresh data.',
    columns: {
      timestamp: 'Timestamp',
      username: 'Username',
      endpoint: 'Endpoint',
      httpMethod: 'Method',
      result: 'Result',
      ipAddress: 'IP Address',
      duration: 'Duration',
      actions: 'Actions',
      dateTime: 'Date & Time',
      request: 'Request',
      responseTime: 'Response Time',
    },
    filters: {
      searchByUsername: 'Enter username (filters instantly)',
      endpoint: 'Enter endpoint (filters instantly)',
      httpMethod: 'HTTP Method',
      result: 'Result',
      ipAddress: 'Enter IP address...',
      responseTime: 'Min Response Time (ms)',
      startDate: 'Start Date',
      endDate: 'End Date',
    },
    status: {
      all: 'All Results',
      success: 'Success',
      error: 'Error',
      failed: 'Failed',
    },
    methods: {
      all: 'All Methods',
      get: 'GET',
      post: 'POST',
      put: 'PUT',
      delete: 'DELETE',
      patch: 'PATCH',
    },
    details: {
      title: 'Audit Log Details',
      id: 'ID',
      userId: 'User ID',
      username: 'Username',
      httpMethod: 'HTTP Method',
      endpoint: 'Endpoint',
      requestId: 'Request ID',
      result: 'Result',
      statusCode: 'Status Code',
      errorMessage: 'Error Message',
      ipAddress: 'IP Address',
      sessionId: 'Session ID',
      duration: 'Duration (ms)',
      timestamp: 'Timestamp',
      userAgent: 'User Agent'
    },
    noData: 'No audit logs found',
    loading: 'Loading audit logs...',
    error: 'Failed to load audit logs',
    refresh: 'Refresh',
    viewDetails: 'View Details',
  },
  appSettings: {
    title: 'App Settings',
    description: 'Manage application settings and configurations',
    list: {
      title: 'App Settings',
      new: 'New Setting',
      edit: 'Edit Setting',
      delete: 'Delete Setting',
      search: 'Search settings...',
      noData: 'No settings found',
      loading: 'Loading settings...',
      error: 'Failed to load settings',
    },
    form: {
      key: 'Key',
      value: 'Value',
      description: 'Description',
      type: 'Type',
      category: 'Category',
      isActive: 'Active',
      save: 'Save',
      cancel: 'Cancel',
      required: 'This field is required',
    },
    actions: {
      create: 'Create Setting',
      update: 'Update Setting',
      delete: 'Delete Setting',
      refresh: 'Refresh',
    },
    messages: {
      createSuccess: 'Setting created successfully',
      updateSuccess: 'Setting updated successfully',
      deleteSuccess: 'Setting deleted successfully',
      createError: 'Failed to create setting',
      updateError: 'Failed to update setting',
      deleteError: 'Failed to delete setting',
    },
  },
  profile: {
    noEmailProvided: 'No email provided',
    tabs: {
      personal: 'Personal Info',
      security: 'Security',
      activity: 'Activity',
    },
    form: {
      nickname: 'Nickname',
      email: 'Email',
      countryCode: 'Country Code',
      mobileNumber: 'Mobile Number',
      currentPassword: 'Current Password',
      newPassword: 'New Password',
      confirmPassword: 'Confirm New Password',
    },
    changePassword: 'Change Password',
    updatePassword: 'Update Password',
    updateSuccess: 'Profile updated successfully',
    updateError: 'Error updating profile',
    passwordChangeSuccess: 'Password changed successfully',
    passwordChangeError: 'Error changing password',
    loginActivity: 'Login Activity',
    lastLogin: 'Last Login',
    lastIP: 'Last IP',
    failedAttempts: 'Failed Attempts',
    accountStatus: 'Account Status',
    deviceSessions: 'Device Sessions',
    noActiveSessions: 'No active sessions found',
  },
  settings: {
    description: 'Manage your application preferences and settings',
    settingsUpdated: 'Settings updated successfully',
    settingsReset: 'Settings reset to defaults',
    themeChanged: 'Theme changed successfully',
    languageChanged: 'Language changed successfully',
    colorThemeChanged: 'Color theme changed successfully',
    resetAll: 'Reset All Settings',
    appearance: {
      title: 'Appearance',
      theme: 'Theme',
      darkMode: 'Dark Mode',
      lightMode: 'Light Mode',
      language: 'Language',
      languageDescription: 'Select your preferred language',
      selectLanguage: 'Language',
      colorTheme: 'Color Theme',
      colorThemeDescription: 'Choose your preferred color scheme',
      selectColorTheme: 'Select Color',
    },
    notifications: {
      title: 'Notifications',
      pushNotifications: 'Push Notifications',
      pushDescription: 'Receive notifications within the application',
      emailNotifications: 'Email Notifications',
      emailDescription: 'Receive email notifications for important updates',
    },
    security: {
      title: 'Security',
      securityAlerts: 'Security Alerts',
      alertsDescription: 'Get notified about suspicious activities',
      cookieConsent: 'Cookie Consent',
      cookieDescription: 'Allow cookies to enhance your experience',
      autoLogout: 'Auto Logout',
      autoLogoutDescription: 'Automatically log out after period of inactivity',
    },
  },
  users: {
    username: 'Username',
    nickname: 'Nickname',
    fullName: 'Full Name',
    email: 'Email',
    password: 'Password',
    mobileCountryCode: 'Country Code',
    mobileNumber: 'Mobile Number',
    status: 'Status',
    roles: 'Roles',
    lastLogin: 'Last Login',
    active: 'Active',
    addUser: 'Add User',
    createUser: 'Create User',
    editUser: 'Edit User',
    viewUser: 'View User',
    deleteUser: 'Delete User',
    searchUsers: 'Search users...',
    export: 'Export',
    import: 'Import',
    deleteConfirmation: 'Are you sure you want to delete user "{{username}}"?',
    tabs: {
      all: 'All Users',
      active: 'Active',
      locked: 'Locked',
      suspended: 'Suspended',
      pending: 'Pending',
    },
    actions: {
      view: 'View',
      edit: 'Edit',
      delete: 'Delete',
    },
  },
  roles: {
    name: 'Role Name',
    description: 'Description',
    permissions: 'Permissions',
    userCount: 'Users',
    status: 'Status',
    active: 'Active',
    lastUpdated: 'Last Updated',
    addRole: 'Add Role',
    editRole: 'Edit Role',
    viewRole: 'View Role',
    createRole: 'Create Role',
    deleteRole: 'Delete Role',
    searchRoles: 'Search roles...',
    export: 'Export',
    deleteConfirmation: 'Are you sure you want to delete role "{{roleName}}"?',
    deleteWarning: 'This role is currently assigned to {{userCount}} user(s). Deleting it will remove the role from all users.',
    actions: {
      view: 'View',
      edit: 'Edit',
      delete: 'Delete',
    },
  },
};

// Chinese translations
const zhResources = {
  app: {
    title: '管理控制台',
  },
  common: {
    loading: '加载中...',
    error: '发生错误',
    retry: '重试',
    cancel: '取消',
    confirm: '确认',
    save: '保存',
    delete: '删除',
    edit: '编辑',
    add: '添加',
    search: '搜索',
    filter: '筛选',
    all: '全部',
    actions: '操作',
    clearAll: '清除全部',
    searchFilters: '搜索筛选',
    yes: '是',
    no: '否',
    close: '关闭',
    view: '查看',
    goBack: '返回',
    goHome: '回到首页',
    viewAll: '查看全部',
    lightMode: '亮色模式',
    darkMode: '暗色模式',
    notifications: '通知',
    userMenu: '用户菜单',
    collapseSidebar: '收起侧边栏',
    expandSidebar: '展开侧边栏',
    notAvailable: '不可用',
    apply: '应用',
    today: '今天',
    yesterday: '昨天',
    last7Days: '最近7天',
    last30Days: '最近30天',
    thisMonth: '本月',
    lastMonth: '上月',
    selectDateRange: '选择日期范围',
    dateRange: '日期范围',
    startDate: '开始日期',
    endDate: '结束日期',
    createdAt: '创建时间',
    updatedAt: '更新时间',
    createdBy: '创建者',
    updatedBy: '更新者',
  },
  navigation: {
    dashboard: '仪表板',
    profile: '个人资料',
    settings: '设置',
    logout: '退出登录',
    users: '用户管理',
    usersList: '用户列表',
    roles: '角色管理',
  },
  auth: {
    unauthorized: '您无权访问此页面',
    sessionExpired: '会话已过期，请重新登录',
  },
  login: {
    title: '登录管理控制台',
    tabs: {
      username: '用户名',
      email: '电子邮箱',
      mobile: '手机',
    },
    form: {
      username: '用户名',
      email: '电子邮箱',
      password: '密码',
      countryCode: '区号',
      mobileNumber: '手机号码',
      submit: '登录',
      forgotPassword: '忘记密码？',
    },
    errors: {
      invalidCredentials: '无效的凭据',
      accountLocked: '帐户已锁定',
      generalError: '登录失败，请重试。',
    },
    success: '登录成功',
  },
  errors: {
    notFound: '页面不存在',
    serverError: '服务器错误',
    networkError: '网络错误，请检查您的连接。',
    pageNotFoundMessage: '您要查找的页面可能已被删除、更名或暂时不可用。',
    unauthorized: '无访问权限',
    unauthorizedTitle: '您无权访问此页面',
    unauthorizedMessage: '如果您认为自己应该有权访问此页面，请联系管理员。',
  },
  dashboard: {
    title: '📊 仪表板总览',
    welcome: '欢迎回来',
    summary: '摘要',
    updated: '更新时间',
    recentLoginActivity: {
      title: '最近登陆',
      viewAll: '查看全部',
    },
    stats: {
      totalUsers: '总用户数',
      activeSessions: '活跃会话',
      activeUsers: '活跃用户',
      lockedUsers: '锁定用户',
      suspendedUsers: '暂停用户',
      pendingVerification: '待验证用户',
    },
    actions: {
      tokenAuth: '令牌认证',
      tokenRevoke: '令牌撤销',
      tokenValidate: '令牌验证',
      userCreate: '用户创建',
      userUpdate: '用户更新',
      userDelete: '用户删除',
      userAction: '用户操作',
      userLogin: '用户登录',
      userLogout: '用户登出',
      passwordReset: '密码重置',
      roleManagement: '角色管理',
      auditAccess: '审计日志访问',
      dashboardAccess: '仪表板访问',
      apiAccess: 'API访问',
    },
    errors: {
      fetchFailed: '获取仪表板统计信息失败',
      loadFailed: '加载仪表板统计信息失败',
      tryAgain: '请稍后重试。',
    },
    unknownUser: '未知用户',
  },
  auditLogs: {
    title: '审计日志',
    showFilters: '显示筛选',
    hideFilters: '隐藏筛选',
    active: '个激活',
    smartFilteringTooltip: '智能筛选：在您输入时立即筛选，快速获得结果。使用"搜索"按钮进行服务器端筛选并获取最新数据。',
    columns: {
      timestamp: '时间戳',
      username: '用户名',
      endpoint: '端点',
      httpMethod: '方法',
      result: '结果',
      ipAddress: 'IP地址',
      duration: '耗时',
      actions: '操作',
      dateTime: '日期和时间',
      request: '请求',
      responseTime: '响应时间',
    },
    filters: {
      searchByUsername: '输入用户名（实时筛选）',
      endpoint: '输入端点（实时筛选）',
      httpMethod: 'HTTP方法',
      result: '结果',
      ipAddress: '输入IP地址...',
      responseTime: '最小响应时间 (毫秒)',
      startDate: '开始日期',
      endDate: '结束日期',
    },
    status: {
      all: '所有结果',
      success: '成功',
      error: '错误',
      failed: '失败',
    },
    methods: {
      all: '所有方法',
      get: 'GET',
      post: 'POST',
      put: 'PUT',
      delete: 'DELETE',
      patch: 'PATCH',
    },
    details: {
      title: '审计日志详情',
      id: 'ID',
      userId: '用户ID',
      username: '用户名',
      httpMethod: 'HTTP方法',
      endpoint: '端点',
      requestId: '请求ID',
      result: '结果',
      statusCode: '状态码',
      errorMessage: '错误信息',
      ipAddress: 'IP地址',
      sessionId: '会话ID',
      duration: '耗时 (毫秒)',
      timestamp: '时间戳',
      userAgent: '用户代理'
    },
    noData: '未找到审计日志',
    loading: '加载审计日志中...',
    error: '加载审计日志失败',
    refresh: '刷新',
    viewDetails: '查看详情',
  },
  profile: {
    noEmailProvided: '未提供电子邮件',
    tabs: {
      personal: '个人信息',
      security: '安全',
      activity: '活动',
    },
    form: {
      nickname: '昵称',
      email: '电子邮件',
      countryCode: '国家代码',
      mobileNumber: '手机号码',
      currentPassword: '当前密码',
      newPassword: '新密码',
      confirmPassword: '确认新密码',
    },
    changePassword: '更改密码',
    updatePassword: '更新密码',
    updateSuccess: '个人资料更新成功',
    updateError: '更新个人资料时出错',
    passwordChangeSuccess: '密码更改成功',
    passwordChangeError: '更改密码时出错',
    loginActivity: '登录活动',
    lastLogin: '上次登录',
    lastIP: '最后登录IP',
    failedAttempts: '失败的尝试',
    accountStatus: '帐户状态',
    deviceSessions: '设备会话',
    noActiveSessions: '未找到活动会话',
  },
  settings: {
    description: '管理您的应用程序偏好设置和设置',
    settingsUpdated: '设置更新成功',
    settingsReset: '设置重置为默认值',
    themeChanged: '主题更改成功',
    languageChanged: '语言更改成功',
    colorThemeChanged: '颜色主题更改成功',
    resetAll: '重置所有设置',
    appearance: {
      title: '外观',
      theme: '主题',
      darkMode: '暗色模式',
      lightMode: '亮色模式',
      language: '语言',
      languageDescription: '选择您首选的语言',
      selectLanguage: '语言',
      colorTheme: '颜色主题',
      colorThemeDescription: '选择您偏好的颜色方案',
      selectColorTheme: '选择颜色',
    },
    notifications: {
      title: '通知',
      pushNotifications: '推送通知',
      pushDescription: '在应用程序内接收通知',
      emailNotifications: '电子邮件通知',
      emailDescription: '接收重要更新的电子邮件通知',
    },
    security: {
      title: '安全',
      securityAlerts: '安全警报',
      alertsDescription: '获取可疑活动的通知',
      cookieConsent: 'Cookie 同意',
      cookieDescription: '允许使用 Cookie 以增强您的体验',
      autoLogout: '自动注销',
      autoLogoutDescription: '在一段时间不活动后自动注销',
    },
  },
  users: {
    username: '用户名',
    nickname: '昵称',
    fullName: '全名',
    email: '邮箱',
    password: '密码',
    mobileCountryCode: '国家代码',
    mobileNumber: '手机号码',
    status: '状态',
    roles: '角色',
    lastLogin: '最后登录',
    active: '启用',
    addUser: '添加用户',
    createUser: '创建用户',
    editUser: '编辑用户',
    viewUser: '查看用户',
    deleteUser: '删除用户',
    searchUsers: '搜索用户...',
    export: '导出',
    import: '导入',
    deleteConfirmation: '确定要删除用户 "{{username}}" 吗？',
    tabs: {
      all: '所有用户',
      active: '活跃',
      locked: '锁定',
      suspended: '挂起',
      pending: '待审核',
    },
    actions: {
      view: '查看',
      edit: '编辑',
      delete: '删除',
    },
  },
  roles: {
    name: '角色名称',
    description: '描述',
    permissions: '权限',
    userCount: '用户数',
    status: '状态',
    active: '启用',
    lastUpdated: '最后更新',
    addRole: '添加角色',
    editRole: '编辑角色',
    viewRole: '查看角色',
    createRole: '创建角色',
    deleteRole: '删除角色',
    searchRoles: '搜索角色...',
    export: '导出',
    deleteConfirmation: '确定要删除角色 "{{roleName}}" 吗？',
    deleteWarning: '此角色当前分配给 {{userCount}} 个用户。删除它将从所有用户中移除该角色。',
    actions: {
      view: '查看',
      edit: '编辑',
      delete: '删除',
    },
  },
};

// Initialize i18next
i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources: {
      en: {
        translation: enResources,
      },
      zh: {
        translation: zhResources,
      },
    },
    lng: APP_CONFIG.DEFAULT_LANGUAGE,
    fallbackLng: 'en',
    interpolation: {
      escapeValue: false, // React already safes from XSS
    },
    detection: {
      order: ['localStorage', 'navigator'],
      caches: ['localStorage'],
      lookupLocalStorage: 'gjpb_language',
    },
    debug: import.meta.env.DEV, // Enable debug logs in development
    keySeparator: '.',
    nsSeparator: ':',
    returnEmptyString: false,
    returnNull: false,
  }).catch(err => console.error('i18n initialization error:', err));

// Check if i18n has been initialized correctly
if (!i18n.isInitialized) {
  console.warn('i18n has not been properly initialized!');
}

export default i18n;